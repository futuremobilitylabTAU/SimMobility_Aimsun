for i in {1..40}; do cd  &&  echo "iteration" $i  &&  cd "/home/yedidya/simmobility/dev/Basic" &&  Release/SimMobility_Medium data/simulation2017_new_lua.xml data/simrun_MidTerm2017_new_lua.xml &&  mkdir -p /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Demand &&  mkdir -p /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Supply &&  mkdir -p /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/temp &&  cp /home/yedidya/simmobility/dev/Basic/activity_schedule /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Demand/das_"$i" &&  python3 /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/Scripts/simo_outputs.py $i;  python3 /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/Scripts/simo_taz_change.py $i &&  cp /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/model.ang /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Supply/iteration_"$i".ang &&  cd &&  cd "/home/yedidya/Aimsun_Next_22" &&  ./aconsole -v --log --log_file "/home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Supply/log_iteraration_"$i"" --project "/home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Supply/iteration_"$i".ang" --command execute --target 18393713 &&  cd &&  sudo -i -u postgres psql tel_aviv_1 -c "COPY demand.learned_amcosts TO '/home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/temp/prev_learned_amcosts.csv' CSV HEADER ESCAPE '''';" &&  cp /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/temp/prev_learned_amcosts.csv /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Demand/prev_learned_amcosts_"$i".csv &&  python3 /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/Scripts/aimso-outputs.py $i &&   cp /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/"$i"/Demand/am_from_sim_"$i".csv /home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/temp/learned_amcosts.csv &&  sudo -i -u postgres psql tel_aviv_1 -c " DELETE FROM demand.learned_amcosts" &&  sudo -i -u postgres psql tel_aviv_1 -c "COPY demand.learned_amcosts FROM '/home/yedidya/Dropbox/Operating_Autonomous_Vehicles_in_Israel/Rebalance/Full_Rebalance/temp/learned_amcosts.csv' DELIMITER ',' CSV HEADER ;" &&  echo "done iteration -------------------------------------------------------------------------------------------------"; done

